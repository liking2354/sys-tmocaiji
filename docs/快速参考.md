# 前端重构 - 快速参考指南

## 📁 新的文件结构

```
public/assets/
├── css/
│   ├── vendor/                    # 第三方库（不修改）
│   ├── common/                    # 公共样式
│   │   ├── variables.css          # CSS 变量定义
│   │   ├── base.css               # 基础样式
│   │   ├── layout.css             # 布局样式
│   │   ├── utilities.css          # 工具类
│   │   └── responsive.css         # 响应式设计
│   ├── modules/                   # 功能模块样式（待添加）
│   ├── components/                # 组件样式（待添加）
│   └── main.css                   # 主样式文件（导入所有）
│
└── js/
    ├── vendor/                    # 第三方库（不修改）
    ├── common/                    # 公共脚本
    │   ├── utils.js               # 工具函数库
    │   ├── notifications.js       # 通知管理
    │   ├── api.js                 # API 调用封装
    │   └── layout.js              # 布局交互脚本
    ├── modules/                   # 功能模块脚本（待添加）
    ├── components/                # 组件脚本（待添加）
    └── main.js                    # 主脚本文件（初始化）
```

---

## 🛠️ 常用工具函数

### Utils 工具库

```javascript
// 防抖
Utils.debounce(function() { /* ... */ }, 300);

// 节流
Utils.throttle(function() { /* ... */ }, 1000);

// 深拷贝
const copy = Utils.deepClone(obj);

// 合并对象
const merged = Utils.merge(target, source);

// 格式化日期
Utils.formatDate(new Date(), 'yyyy-MM-dd HH:mm:ss');

// 格式化文件大小
Utils.formatFileSize(1024); // "1 KB"

// 生成 UUID
const uuid = Utils.generateUUID();

// URL 参数管理
Utils.getUrlParam('id');
Utils.setUrlParam('id', '123');
Utils.removeUrlParam('id');

// 视口检测
Utils.isInViewport(element);

// 平滑滚动
Utils.scrollToElement('#target', 100);

// 复制到剪贴板
Utils.copyToClipboard('text');

// 延迟执行
await Utils.delay(1000);

// 重试机制
await Utils.retry(async () => { /* ... */ }, 3, 1000);

// 表单验证
Utils.isValidEmail('test@example.com');
Utils.isValidPhone('13800138000');
Utils.isValidUrl('https://example.com');
```

### Notifications 通知系统

```javascript
// 成功通知
Notifications.success('操作成功');
Notifications.success('操作成功', '成功', { timeOut: 3000 });

// 错误通知
Notifications.error('操作失败');

// 警告通知
Notifications.warning('请注意');

// 信息通知
Notifications.info('提示信息');

// 加载中
const $loading = Notifications.loading('加载中...');

// 确认对话框
Notifications.confirm('确定删除吗？', function() {
    // 确认回调
}, function() {
    // 取消回调
});

// 提示对话框
const result = Notifications.prompt('请输入名称', '默认值');

// 警告对话框
Notifications.alert('警告信息');

// 清除所有通知
Notifications.clear();

// 设置配置
Notifications.setOptions({
    timeOut: 5000,
    positionClass: 'toast-top-right'
});
```

### API 调用

```javascript
// GET 请求
API.get('/api/users').done(function(data) {
    console.log(data);
}).fail(function(error) {
    console.error(error);
});

// POST 请求
API.post('/api/users', { name: 'John' }).done(function(data) {
    console.log(data);
});

// PUT 请求
API.put('/api/users/1', { name: 'Jane' }).done(function(data) {
    console.log(data);
});

// DELETE 请求
API.del('/api/users/1').done(function(data) {
    console.log(data);
});

// PATCH 请求
API.patch('/api/users/1', { status: 'active' }).done(function(data) {
    console.log(data);
});

// 文件上传
const formData = new FormData();
formData.append('file', fileInput.files[0]);
API.upload('/api/upload', formData, function(progress) {
    console.log('上传进度:', progress + '%');
});

// 文件下载
API.download('/api/export', 'data.xlsx');

// JSON 请求
API.json('/api/data', 'POST', { key: 'value' }).done(function(data) {
    console.log(data);
});

// 批量请求
$.when(
    API.get('/api/users'),
    API.get('/api/roles')
).done(function(users, roles) {
    console.log(users, roles);
});

// 超时处理
API.withTimeout(API.get('/api/data'), 5000).done(function(data) {
    console.log(data);
}).fail(function(error) {
    console.error('请求超时或失败');
});

// 请求重试
API.retry(function() {
    return API.get('/api/data');
}, 3, 1000).done(function(data) {
    console.log(data);
});

// 全局错误处理
API.onError(function(jqxhr, settings, thrownError) {
    console.error('请求错误:', thrownError);
});

// 全局成功处理
API.onSuccess(function(jqxhr, settings) {
    console.log('请求成功');
});

// 全局完成处理
API.onComplete(function(jqxhr, settings) {
    console.log('请求完成');
});

// 获取 CSRF Token
const token = API.getCsrfToken();
```

### Layout 布局

```javascript
// 初始化所有布局功能
Layout.init();

// 初始化侧边栏
Layout.initSidebar();

// 初始化导航栏
Layout.initNavbar();

// 初始化提示信息
Layout.initAlerts();
```

---

## 🎨 CSS 变量使用

```css
/* 颜色 */
color: var(--primary-color);           /* #3498db */
color: var(--secondary-color);         /* #2c3e50 */
color: var(--accent-color);            /* #1abc9c */
background-color: var(--light-bg);     /* #f8f9fa */

/* 阴影 */
box-shadow: var(--card-shadow);        /* 0 4px 6px rgba(0, 0, 0, 0.1) */
box-shadow: var(--button-shadow);      /* 0 4px 8px rgba(0, 0, 0, 0.1) */
box-shadow: var(--hover-shadow);       /* 0 2px 5px rgba(0, 0, 0, 0.2) */

/* 字体 */
font-family: var(--font-family);       /* 'Segoe UI', Tahoma, ... */
font-size: var(--font-size-base);      /* 14px */
font-weight: var(--font-weight-bold);  /* 600 */

/* 间距 */
margin: var(--spacing-md);             /* 16px */
padding: var(--spacing-lg);            /* 24px */

/* 圆角 */
border-radius: var(--border-radius-md); /* 8px */

/* 过渡 */
transition: var(--transition-default);  /* all 0.3s ease */

/* 布局 */
height: calc(100vh - var(--navbar-height)); /* 100vh - 70px */
width: var(--sidebar-width);           /* 250px */
```

---

## 📝 页面级样式和脚本

### 添加页面级样式

```blade
@push('styles')
<style>
    /* 页面级样式 */
    .custom-class {
        color: red;
    }
</style>
@endpush
```

### 添加页面级脚本

```blade
@push('scripts')
<script>
    // 页面级脚本
    $(document).ready(function() {
        // 初始化页面功能
    });
</script>
@endpush
```

---

## 🧪 测试检查清单

### 功能测试
- [ ] 页面加载正常
- [ ] 导航栏显示正常
- [ ] 侧边栏展开/收起正常
- [ ] 菜单导航正常
- [ ] 所有按钮功能正常
- [ ] 所有表单提交正常
- [ ] 所有 AJAX 请求正常
- [ ] 通知提示显示正常

### 样式测试
- [ ] 颜色显示正确
- [ ] 字体显示正确
- [ ] 间距显示正确
- [ ] 阴影显示正确
- [ ] 圆角显示正确

### 响应式测试
- [ ] 手机端显示正常 (< 576px)
- [ ] 平板端显示正常 (577px - 768px)
- [ ] 桌面端显示正常 (> 768px)
- [ ] 超大屏幕显示正常 (> 1200px)

### 浏览器兼容性
- [ ] Chrome (最新版)
- [ ] Firefox (最新版)
- [ ] Safari (最新版)
- [ ] Edge (最新版)

---

## 🚀 常见问题

### Q: 如何添加新的 CSS 变量？
A: 编辑 `public/assets/css/common/variables.css`，在 `:root` 中添加新变量。

### Q: 如何添加新的工具函数？
A: 编辑 `public/assets/js/common/utils.js`，在 `Utils` 对象中添加新函数。

### Q: 如何添加新的模块样式？
A: 在 `public/assets/css/modules/` 中创建新文件，然后在 `main.css` 中导入。

### Q: 如何添加新的模块脚本？
A: 在 `public/assets/js/modules/` 中创建新文件，然后在 `main.js` 中加载。

### Q: 页面级样式和脚本如何添加？
A: 使用 `@push('styles')` 和 `@push('scripts')` 在 Blade 模板中添加。

### Q: 如何调试 JavaScript？
A: 打开浏览器开发者工具 (F12)，在 Console 中查看错误信息。

### Q: 如何修改主题颜色？
A: 编辑 `public/assets/css/common/variables.css` 中的 `--primary-color` 等变量。

---

## 📚 相关文档

- [前端重构方案](./前端重构方案.md) - 完整的重构方案
- [第一阶段实施总结](./第一阶段实施总结.md) - 第一阶段的详细总结

---

**最后更新**：2025-10-30  
**版本**：1.0
